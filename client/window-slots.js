!function(){function _getCompiled(nools){return function(){return function(options){options=options||{};var defined={Array:Array,String:String,Number:Number,Boolean:Boolean,RegExp:RegExp,Date:Date,Object:Object},scope=options.scope||{},optDefined=options.defined||{};for(var i in optDefined)defined[i]=optDefined[i];return nools.flow("window-slots",function(){var WindowSlot=defined.WindowSlot=this.addDefined("WindowSlot",function(){var Defined=function(opts){for(var i in opts)opts.hasOwnProperty(i)&&(this[i]=opts[i])},proto=Defined.prototype;return proto.actions=null,proto.slot_id=-1,proto.content=null,proto.slot_element=null,Defined}()),Action=defined.Action=this.addDefined("Action",function(){var Defined=function(opts){for(var i in opts)opts.hasOwnProperty(i)&&(this[i]=opts[i])},proto=Defined.prototype;return proto.sub_type="",proto.slot_id=-1,proto.content=null,Defined}());scope.console=console,this.rule("Load into empty slot",{scope:scope},[[Action,"a",'a.sub_type === "load"'],[WindowSlot,"ws","ws.content === null && a.slot_id === ws.slot_id"]],function(facts,flow,next){var a=facts.a,a=facts.a,ws=facts.ws,ws=facts.ws,a=facts.a,modify=flow.modify,retract=flow.retract;modify(ws,function(){ws.content=a.content}),retract(a),ws.actions.load().then(function(){next()}).catch(function(){next()})}),this.rule("Unload slot",{scope:scope},[[Action,"a",'a.sub_type === "unload"'],[WindowSlot,"ws","a.slot_id === ws.slot_id"]],function(facts,flow,next){var a=facts.a,a=facts.a,ws=facts.ws,a=facts.a,ws=facts.ws,modify=flow.modify,retract=flow.retract;ws.actions.unload().then(function(){modify(ws,function(){ws.content=null}),retract(a),next()}).catch(function(){modify(ws,function(){ws.content=null}),retract(a),next()})}),this.rule("Load into occupied slot",{scope:scope},[[Action,"a",'a.sub_type === "load"'],[WindowSlot,"ws","ws.content !== null && a.slot_id === ws.slot_id"]],function(facts,flow){facts.a,facts.a;var ws=facts.ws,ws=facts.ws;facts.a;var assert=flow.assert;assert(new Action({slot_id:ws.slot_id,sub_type:"unload"}))})})}}()}"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(module.exports=_getCompiled(require("nools"))):"function"==typeof define&&define.amd?define(["nools"],function(nools){return _getCompiled(nools)}):_getCompiled(this.nools)()}.call(this);